#!/bin/sh

# DMENU_RUN-DESKTOP
# -----------------

# Alternative to dmenu_run that only lists executables from .desktop files
# Dependency: gtk-launch (part of gtk3 package in arch)

dmenu_cmd="fzfmenu --prompt='Apps: '"

dir='/usr/share/applications'

appfile=$(
    for f in "$dir"/*; do
        case "$f" in
            *.desktop)
                if [ -f "$f" ]; then
                    f="${f#$dir/}"
                    printf '%s\n' "${f%.desktop}"
                fi ;;
        esac
    done | $dmenu_cmd
)

[ -f "$dir/$appfile.desktop" ] && gtk-launch "$appfile"